# Consistency Policy 测试结果

**测试日期**: 2026-01-07  
**测试人员**: lizh  
**环境**: arx-py310  
**机器人**: ARX5 (X5)  

---

## 测试环境

| 项目 | 值 |
|------|-----|
| 操作系统 | Ubuntu (Linux) |
| Python 版本 | 3.10.x |
| Conda 环境 | arx-py310 |
| arx5-sdk 版本 | 本地编译 |
| pyrealsense2 版本 | 已安装 |

---

## 1. 相机测试 (test_camera.py)

### 1.1 相机检测

| 检测项 | 结果 | 备注 |
|--------|------|------|
| pyrealsense2 安装 | ✅ | |
| D435i 检测 (腕部) | ✅ | SN: 036222071712 |
| D455 检测 (外部) | ✅ | SN: 037522250003 |

### 1.2 腕部相机 (D435i)

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 启动成功 | ✅ | | |
| RGB 采集 | ✅ | | 640x480 |
| 帧率 | ✅ | 50.2 Hz | 30 Hz |
| 延迟 | ✅ | | <50 ms |

### 1.3 外部相机 (D455)

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 启动成功 | ✅ | | |
| RGB 采集 | ✅ | | 640x480 |
| 帧率 | ✅ | 45.4 Hz | 30 Hz |
| 录制功能 | ✅ | test_recording_20260107_124744.mp4 | |

### 1.4 双相机同步

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 同时启动 | ✅ | | |
| 同步帧率 | ✅ | 31.1 Hz | ~30 Hz |

---

## 2. 控制器测试 (test_controller.py)

### 2.1 启动/停止

| 测试项 | 结果 | 备注 |
|--------|------|------|
| 控制器启动 | ✅ | |
| 进程存活 | ✅ | PID: 3411962 |
| 正常停止 | ✅ | |

### 2.2 状态读取

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 关节位置获取 | ✅ | [0.0051, -0.001, 0.0036, -0.0525, -0.0036, 0.0002] | 6 DOF |
| 关节速度获取 | ✅ | [0.0044, 0.022, 0.2593, 0.0549, -0.011, -0.033] | 6 DOF |
| 夹爪位置获取 | ✅ | 0.0007 | |
| 读取频率 | ✅ | **11794 Hz** | >1000 Hz |

### 2.3 servoL 点对点移动

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 移动完成 | ✅ | | |
| 最大位置误差 | ✅ | **0.0097 rad** | <0.05 rad |
| 移动时间 | ✅ | 3.0 s | ~3 s |

### 2.4 轨迹调度

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 路点添加 | ✅ | | 50 个 |
| 轨迹更新 | ✅ | | |
| 轨迹执行 | ✅ | 5.0 s | 5 s |
| 跟踪误差 | ✅ | **0.7°** | <3° |

---

## 3. 轨迹回放测试 (test_robot_replay.py)

### 3.1 基本功能

| 测试项 | 结果 | 备注 |
|--------|------|------|
| HDF5 文件加载 | ✅ | 461 帧 |
| 控制器初始化 | ✅ | PID: 3420113 |
| 起始位置移动 | ✅ | servoL 3s |

### 3.2 回放精度

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 回放帧数 | ✅ | 461 帧 | |
| 平均位置误差 | ✅ | **0.0349 rad** | <0.1 rad |
| 最大位置误差 | ✅ | **0.0680 rad** | <0.1 rad |
| 回放耗时 | ✅ | 53.96 s | ~51 s (30% 速度) |
| 夹爪误差 (Mean) | ✅ | 0.0011 m | |
| 夹爪误差 (Max) | ✅ | 0.0137 m | |

### 3.3 配置

| 参数 | 值 |
|------|-----|
| Demo 路径 | ~/.arx_demos/processed/pick_cube/20251218_235920/trajectory.h5 |
| 速度缩放 | 30% |
| 批量大小 | 16 |
| 控制模式 | add_waypoint() + update_trajectory() |

---

## 4. 策略推理测试 (test_offline_inference.py)

### 4.1 模型加载

| 测试项 | 结果 | 备注 |
|--------|------|------|
| 模型文件存在 | ✅ | iter_48000.pt |
| 模型加载成功 | ✅ | |
| EMA 权重 | ✅ | True |

### 4.2 推理性能

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 推理速度 | ✅ | **15.44 it/s** (~65ms) | ~70 ms |
| 输出维度 | ✅ | 7 | 7 (6 关节 + 1 夹爪) |
| MSE | ✅ | 0.000049 | |
| MAE | ✅ | **0.005372** | <0.1 |

### 4.3 各维度 MAE

| 维度 | MAE |
|------|-----|
| Joint0 | 0.005430 |
| Joint1 | 0.007136 |
| Joint2 | 0.005320 |
| Joint3 | 0.005766 |
| Joint4 | 0.004276 |
| Joint5 | 0.004371 |
| Gripper | 0.005303 |

### 4.4 配置

| 参数 | 值 |
|------|-----|
| Checkpoint | consistency_flow-pick_cube-real__1__1766132160/checkpoints/iter_48000.pt |
| 算法 | consistency_flow |
| 参数量 | 15.52M |

---

## 5. 端到端集成测试

### 5.1 实时控制

| 测试项 | 结果 | 实测值 | 期望值 |
|--------|------|--------|--------|
| 控制回路频率 | ✅ | 200 Hz | 200 Hz |
| 状态读取频率 | ✅ | 11794 Hz | >1000 Hz |
| 推理频率 | ✅ | ~15 Hz | ~14 Hz |

---

## 测试总结

| 测试模块 | 状态 | 备注 |
|----------|------|------|
| 相机测试 | ✅ 全部通过 | D435i + D455 |
| 控制器测试 | ✅ 全部通过 | 200Hz, 定位精度 <0.01 rad |
| 轨迹回放测试 | ✅ 全部通过 | 跟踪误差 0.035 rad |
| 离线推理测试 | ✅ 全部通过 | MAE 0.005, 65ms/iter |

**所有测试通过，系统准备就绪，可以进行真机推理。**

---

## 签字确认

测试人员签字: lizh  
日期: 2026-01-07
